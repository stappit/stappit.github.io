<!DOCTYPE html>

<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">

    <link rel="stylesheet" href="../../css/default.css">

    <link rel="alternate" type="application/atom+xml" title="Brian's feed" href="atom.xml" />

    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

    <title>Brian - Cox Proportional Hazard</title>
  </head>

  <body>
    <nav id="navbar-container" class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container">
        <a class="navbar-brand mr-5" href="../../index.html">Brian</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div id="navbar" class="collapse navbar-collapse justify-content-end">
          <ul class="nav navbar-nav">
            <li class="nav-item"><a class="nav-link" href="../../index.html"><i class="fas fa-home"></i> Recent</a></li>
            <li class="nav-item"><a class="nav-link" href="../../archive.html"><i class="fas fa-archive"></i> Archive</a></li>
            <li class="nav-item"><a class="nav-link" href="https://twitter.com/mcbricall"><i class="fab fa-twitter"></i></a></li>
            <li class="nav-item"><a class="nav-link" href="https://github.com/stappit"><i class="fab fa-github"></i></a></li>
            <li class="nav-item"><a class="nav-link" href="https://www.linkedin.com/in/brian-callander-ba4117140/"><i class="fab fa-linkedin-in"></i></a></li>
            <li class="nav-item"><a class="nav-link" href="https://www.strava.com/athletes/6396953"><i class="fab fa-strava"></i></a></li>
            <li class="nav-item"><a class="nav-link" href="https://www.instagram.com/macbricall/"><i class="fab fa-instagram"></i></a></li>
            <li class="nav-item"><a class="nav-link" href="mailto:briancallander+blog@gmail.com"><i class="far fa-envelope"></i></a></li>
            <li class="nav-item"><a class="nav-link" href="../../atom.xml"><i class="fas fa-rss"></i></a></li>
            <li class="nav-item"><a class="nav-link" href="../../about.html"><i class="fas fa-info-circle"></i> About</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <section>
      <article>
        <div id="content" class="container">
          <h1 class="post-title">Cox Proportional Hazard</h1>

<div class="card post-meta border-0">
  <div class="card-body post-meta">
    <p class="card-text text-muted text-left">
    Posted on September 10, 2018  by Brian </br>
     Tags:  </br>
     Category: <a href="../../categories/survival_models.html">survival_models</a> 
    </p>
  </div>
</div>

<p><a href="./hazard.html">Last time</a> we saw that the hazard function can be modelled directly from <a href="./censoring.html">right-censored time-to-event observations</a> using a Poisson likelihood. In this post, we’ll use those ideas to fit a constant hazard to data using Poisson regression, then exend those ideas to fitting arbitrary hazard functions (again with Poisson regression). This latter model is often called a Cox proportional hazards model. We’ll finish by comparing our Cox model with that provided by the <a href="https://cran.r-project.org/web/packages/survival/index.html">survival package</a>.</p>
<!--more-->
<h2 id="constant-hazard">Constant hazard</h2>
<p>Time-to-event observations have constant hazard when those observations have an exponential distribution. We’ll generate observations from an exponential distribution with mean 5 and with censoring occurring independently of these observations. The hazard should be equal to the reciprocal of the mean, <span class="math inline">\(h = 1 / 5 = 0.2\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="dv">1000</span>
mu &lt;-<span class="st"> </span><span class="dv">5</span>

dfc &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span>N,
  <span class="dt">tte =</span> <span class="kw">rexp</span>(N, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mu),
  <span class="dt">tto =</span> <span class="kw">pmin</span>(<span class="kw">rpois</span>(N, <span class="dv">6</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, tte),
  <span class="dt">censored =</span> tto <span class="op">&lt;</span><span class="st"> </span>tte
)</code></pre></div>
<table class="table table-hover table-striped table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:right;">
tte
</th>
<th style="text-align:right;">
tto
</th>
<th style="text-align:left;">
censored
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1098421
</td>
<td style="text-align:right;">
0.1098421
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5.4689873
</td>
<td style="text-align:right;">
5.4689873
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.6825346
</td>
<td style="text-align:right;">
0.6825346
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
18.5130180
</td>
<td style="text-align:right;">
5.0000000
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4.8422441
</td>
<td style="text-align:right;">
4.8422441
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
8.0623456
</td>
<td style="text-align:right;">
8.0623456
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table>
<p>The <a href="./hazard.html">hazard</a> can be estimated by Poisson regression of the deaths (= -<code>censored</code>) against the exposure time (<code>tto</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfc <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">glm</span>(
    <span class="dt">formula =</span> <span class="op">!</span>censored <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(tto)),
    <span class="dt">family =</span> <span class="kw">poisson</span>(<span class="dt">link =</span> <span class="st">'log'</span>),
    <span class="dt">data =</span> .
  ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pull</span>(estimate) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">exp</span>() <span class="co"># inverse of the log-link</span></code></pre></div>
<pre><code>[1] 0.2120702</code></pre>
<p>As expected, it’s around 0.2.</p>
<h2 id="cox-model">Cox model</h2>
<p>Instead of assuming that our observations are drawn from a specified distribution, we can try to model arbitrary distributions. We do this by breaking up our observations into intervals and modelling the average hazard as a constant in each interval using the method outlined above.</p>
<h3 id="the-unknown-distribution">The unknown distribution</h3>
<p>Let’s use the Weibull distributions as the ‘unknown’ distribution from which our times-to-event are drawn.</p>
<figure>
<img src="cox_models_files/figure-markdown/weibull-1..svg" />
</figure>
<p>The corresponding hazard function is shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(
    <span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">0.1</span>),
    <span class="dt">h =</span> (shape <span class="op">/</span><span class="st"> </span>scale) <span class="op">*</span><span class="st"> </span>(x <span class="op">/</span><span class="st"> </span>scale)<span class="op">^</span>(shape <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)
  ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">aes</span>(x, h) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">y =</span> <span class="st">'Hazard'</span>,
    <span class="dt">title =</span> <span class="kw">str_glue</span>(<span class="st">'Weibull(scale = {scale}, shape = {shape}) hazard function'</span>)
  )</code></pre></div>
<figure>
<img src="cox_models_files/figure-markdown/unnamed-chunk-1-1..svg" />
</figure>
<h3 id="fitting-the-parameters">Fitting the parameters</h3>
<p>Let’s generate data where the <code>tte</code> is generated from the Weibull distribution above, but where the observations <code>tto</code> are censored.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">N &lt;-<span class="st"> </span><span class="dv">1000</span>
mu &lt;-<span class="st"> </span><span class="dv">5</span>

dfa &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span>N,
  <span class="dt">tte =</span> <span class="kw">rweibull</span>(N, shape, scale),
  <span class="dt">tto =</span> <span class="kw">pmin</span>(<span class="kw">rpois</span>(N, <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, tte),
  <span class="dt">censored =</span> tto <span class="op">&lt;</span><span class="st"> </span>tte
)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dfa <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">head</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">'hover'</span>, <span class="st">'striped'</span>, <span class="st">'responsive'</span>))</code></pre></div>
<table class="table table-hover table-striped table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:right;">
tte
</th>
<th style="text-align:right;">
tto
</th>
<th style="text-align:left;">
censored
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.323668
</td>
<td style="text-align:right;">
1.323668
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.705960
</td>
<td style="text-align:right;">
1.705960
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1.442548
</td>
<td style="text-align:right;">
1.442548
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.728064
</td>
<td style="text-align:right;">
1.728064
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1.317017
</td>
<td style="text-align:right;">
1.317017
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1.433494
</td>
<td style="text-align:right;">
1.433494
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table>
<h2 id="comparison-with-survival">Comparison with <code>survival</code></h2>
<h3 id="data">Data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;mastectomy&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;HSAUR&quot;</span>)

df &lt;-<span class="st"> </span>mastectomy <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(time) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">transmute</span>(
    <span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>(),
    <span class="dt">months =</span> time,
    event,
    <span class="dt">metastized =</span> metastized <span class="op">==</span><span class="st"> 'yes'</span>
  ) </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">head</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">'hover'</span>, <span class="st">'striped'</span>, <span class="st">'responsive'</span>))</code></pre></div>
<table class="table table-hover table-striped table-responsive" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:right;">
months
</th>
<th style="text-align:left;">
event
</th>
<th style="text-align:left;">
metastized
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
FALSE
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> event, <span class="dt">y =</span> ..count.. <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(..count..))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">'stack'</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> percent) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">x =</span> <span class="st">'Event observed?'</span>,
    <span class="dt">y =</span> <span class="st">'Fraction of rows'</span>,
    <span class="dt">title =</span> <span class="st">'Censoring in the masectomy dataset'</span>,
    <span class="dt">subtitle =</span> <span class="kw">str_glue</span>(<span class="st">'Total rows: {df %&gt;% nrow()}'</span>)
  )</code></pre></div>
<figure>
<img src="cox_models_files/figure-markdown/unnamed-chunk-3-1..svg" />
</figure>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> months, <span class="dt">x =</span> <span class="kw">reorder</span>(id, months), <span class="dt">fill =</span> event, <span class="dt">width =</span> <span class="fl">0.2</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> metastized)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(
    <span class="dt">y =</span> <span class="st">'Months'</span>,
    <span class="dt">x =</span> <span class="st">'Person'</span>,
    <span class="dt">title =</span> <span class="st">''</span>,
    <span class="dt">fill =</span> <span class="st">'Event?'</span>,
    <span class="dt">alpha =</span> <span class="st">'Metastised?'</span>
  ) </code></pre></div>
<pre><code>Warning: Using alpha for a discrete variable is not advised.</code></pre>
<figure>
<img src="cox_models_files/figure-markdown/metastized_censoring-1..svg" />
</figure>
<h3 id="piecewise-constant-hazard">Piecewise-constant hazard</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">M &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># size of intervals</span>

df1 &lt;-<span class="st"> </span>
<span class="st">  </span><span class="co"># all combos of person and interval</span>
<span class="st">  </span><span class="kw">expand.grid</span>(
    <span class="dt">id =</span> df<span class="op">$</span>id,                           <span class="co"># person</span>
    <span class="dt">lower =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="kw">max</span>(df<span class="op">$</span>months) <span class="op">+</span><span class="st"> </span>M, M) <span class="co"># interval lower bound</span>
  ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="co"># add strict upper bound for the interval</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">upper =</span> lower <span class="op">+</span><span class="st"> </span>M) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="co"># add data for each person</span>
<span class="st">  </span><span class="kw">inner_join</span>(df, <span class="dt">by =</span> <span class="st">'id'</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="co"># exclude people that died in a previous interval</span>
<span class="st">  </span><span class="co"># if months lies on the lower bound, assign death to previous interval</span>
<span class="st">  </span><span class="kw">filter</span>(lower <span class="op">&lt;</span><span class="st"> </span>months) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="co"># add death and exposure info</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">death =</span> <span class="kw">if_else</span>(event <span class="op">&amp;</span><span class="st"> </span>months <span class="op">&lt;=</span><span class="st"> </span>upper, <span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">exposure =</span> <span class="kw">pmin</span>(months <span class="op">-</span><span class="st"> </span>lower, M)
  ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(id, lower)</code></pre></div>
<p>Let’s take a look at some entries to see what this looks like. We should see</p>
<ul>
<li>a row for every interval in which the person was part of the experiment</li>
<li>the sum of the exposures is equal to <code>months</code></li>
<li><code>death</code> is 1 for the last interval if there was no censoring, or 0 otherwise</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(id <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:right;">
lower
</th>
<th style="text-align:right;">
upper
</th>
<th style="text-align:right;">
months
</th>
<th style="text-align:left;">
event
</th>
<th style="text-align:left;">
metastized
</th>
<th style="text-align:right;">
death
</th>
<th style="text-align:right;">
exposure
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>In the case that the event occurred on the lower boundary of an interval, we assign the event to the previous interval. This is why we see a death in interval [15, 18) with exposure 3, rather than in interval [18, 21) with exposure 0. We do this because exposure 0 doesn’t make much sense.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(id <span class="op">==</span><span class="st"> </span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:right;">
lower
</th>
<th style="text-align:right;">
upper
</th>
<th style="text-align:right;">
months
</th>
<th style="text-align:left;">
event
</th>
<th style="text-align:left;">
metastized
</th>
<th style="text-align:right;">
death
</th>
<th style="text-align:right;">
exposure
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<p>For censored cases, <code>death</code> is always 0.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(id <span class="op">==</span><span class="st"> </span><span class="dv">21</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
id
</th>
<th style="text-align:right;">
lower
</th>
<th style="text-align:right;">
upper
</th>
<th style="text-align:right;">
months
</th>
<th style="text-align:left;">
event
</th>
<th style="text-align:left;">
metastized
</th>
<th style="text-align:right;">
death
</th>
<th style="text-align:right;">
exposure
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>We can check these properties for the whole dataset. First, exposure is never zero.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(df1<span class="op">$</span>exposure)</code></pre></div>
<pre><code>[1] 1</code></pre>
<p>The sum of the exposures is equal to the time to observation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">correct =</span> <span class="kw">max</span>(months) <span class="op">==</span><span class="st"> </span><span class="kw">sum</span>(exposure)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(correct) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
correct
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
44
</td>
</tr>
</tbody>
</table>
<p>The sum of all <code>death</code>s is equal to the censoring status.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df1 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">correct =</span> <span class="kw">sum</span>(death) <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(<span class="kw">if_else</span>(event, <span class="dv">1</span>, <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(correct) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>()</code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
correct
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
44
</td>
</tr>
</tbody>
</table>
<h3 id="parameter-fitting">Parameter fitting</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">glm</span>(death <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">ordered</span>(lower) <span class="op">+</span><span class="st"> </span>metastized <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(exposure)), <span class="dt">data =</span> df1, <span class="dt">family =</span> <span class="kw">poisson</span>())

<span class="kw">summary</span>(m)</code></pre></div>
<pre><code>
Call:
glm(formula = death ~ 0 + ordered(lower) + metastized + offset(log(exposure)), 
    family = poisson(), data = df1)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.58529  -0.24104  -0.00004  -0.00003   2.70076  

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)    
ordered(lower)0     -23.0696  3827.8812  -0.006 0.995191    
ordered(lower)3      -5.5604     1.0893  -5.105 3.31e-07 ***
ordered(lower)6      -5.5329     1.0885  -5.083 3.72e-07 ***
ordered(lower)9      -5.4949     1.0874  -5.053 4.35e-07 ***
ordered(lower)12     -5.4654     1.0865  -5.030 4.90e-07 ***
ordered(lower)15     -5.4554     1.0862  -5.022 5.11e-07 ***
ordered(lower)18    -23.0438  4062.5100  -0.006 0.995474    
ordered(lower)21     -4.7271     0.8243  -5.735 9.77e-09 ***
ordered(lower)24     -4.6642     0.8241  -5.659 1.52e-08 ***
ordered(lower)27    -23.0389  4287.7503  -0.005 0.995713    
ordered(lower)30     -5.2883     1.0838  -4.880 1.06e-06 ***
ordered(lower)33     -5.2642     1.0830  -4.861 1.17e-06 ***
ordered(lower)36    -23.0246  4413.9934  -0.005 0.995838    
ordered(lower)39     -4.5081     0.8175  -5.515 3.49e-08 ***
ordered(lower)42    -23.0083  4552.2343  -0.005 0.995967    
ordered(lower)45     -4.4627     0.8168  -5.464 4.66e-08 ***
ordered(lower)48     -5.0876     1.0802  -4.710 2.48e-06 ***
ordered(lower)51    -23.0065  4789.6935  -0.005 0.996168    
ordered(lower)54    -23.0065  4789.6935  -0.005 0.996168    
ordered(lower)57     -5.0430     1.0786  -4.675 2.93e-06 ***
ordered(lower)60     -4.9802     1.0763  -4.627 3.71e-06 ***
ordered(lower)63    -22.9855  4968.1051  -0.005 0.996309    
ordered(lower)66     -4.2541     0.8097  -5.254 1.49e-07 ***
ordered(lower)69     -4.8576     1.0785  -4.504 6.67e-06 ***
ordered(lower)72    -23.0016  5402.8587  -0.004 0.996603    
ordered(lower)75    -22.9473  5361.9290  -0.004 0.996585    
ordered(lower)78    -22.9883  5528.3332  -0.004 0.996682    
ordered(lower)81    -22.9883  5528.3332  -0.004 0.996682    
ordered(lower)84    -22.9883  5528.3332  -0.004 0.996682    
ordered(lower)87    -22.9883  5528.3332  -0.004 0.996682    
ordered(lower)90    -22.9883  5528.3332  -0.004 0.996682    
ordered(lower)93    -22.9883  5528.3332  -0.004 0.996682    
ordered(lower)96    -22.9883  5528.3332  -0.004 0.996682    
ordered(lower)99    -22.9285  5436.2581  -0.004 0.996635    
ordered(lower)102   -23.0377  5819.3232  -0.004 0.996841    
ordered(lower)105   -22.9997  5971.5698  -0.004 0.996927    
ordered(lower)108   -22.9396  6087.4480  -0.004 0.996993    
ordered(lower)111    -4.4585     1.0759  -4.144 3.41e-05 ***
ordered(lower)114   -22.9429  6534.8358  -0.004 0.997199    
ordered(lower)117    -4.2465     1.0670  -3.980 6.90e-05 ***
ordered(lower)120   -22.9249  7018.7916  -0.003 0.997394    
ordered(lower)123   -22.9249  7018.7916  -0.003 0.997394    
ordered(lower)126   -22.9249  7018.7916  -0.003 0.997394    
ordered(lower)129   -22.9249  7018.7916  -0.003 0.997394    
ordered(lower)132   -22.9249  7018.7916  -0.003 0.997394    
ordered(lower)135   -22.9249  7018.7916  -0.003 0.997394    
ordered(lower)138   -22.9249  7018.7916  -0.003 0.997394    
ordered(lower)141    -4.1766     1.0638  -3.926 8.63e-05 ***
ordered(lower)144   -22.7890  7218.0828  -0.003 0.997481    
ordered(lower)147    -3.9388     1.0579  -3.723 0.000197 ***
ordered(lower)150   -22.8936  8000.1167  -0.003 0.997717    
ordered(lower)153   -22.8936  8000.1167  -0.003 0.997717    
ordered(lower)156   -22.8936  8000.1167  -0.003 0.997717    
ordered(lower)159   -22.8936  8000.1167  -0.003 0.997717    
ordered(lower)162   -22.8472  8431.0823  -0.003 0.997838    
ordered(lower)165   -22.8472  8431.0823  -0.003 0.997838    
ordered(lower)168   -22.8472  8431.0823  -0.003 0.997838    
ordered(lower)171   -22.8472  8431.0823  -0.003 0.997838    
ordered(lower)174   -22.8472  8431.0823  -0.003 0.997838    
ordered(lower)177   -22.8472  8431.0823  -0.003 0.997838    
ordered(lower)180    -3.7205     1.0573  -3.519 0.000434 ***
ordered(lower)183   -22.8936  8944.4024  -0.003 0.997958    
ordered(lower)186   -22.8333  8944.2978  -0.003 0.997963    
ordered(lower)189   -22.8337  9559.9126  -0.002 0.998094    
ordered(lower)192   -22.8337  9559.9126  -0.002 0.998094    
ordered(lower)195   -22.8337  9559.9126  -0.002 0.998094    
ordered(lower)198   -22.8936 10328.1063  -0.002 0.998231    
ordered(lower)201   -22.8936 10328.1063  -0.002 0.998231    
ordered(lower)204   -22.8936 10328.1063  -0.002 0.998231    
ordered(lower)207   -22.7370  9882.9134  -0.002 0.998164    
ordered(lower)210   -22.8174 11188.3739  -0.002 0.998373    
ordered(lower)213   -23.0246 14639.5599  -0.002 0.998745    
ordered(lower)216   -22.6215 14054.6481  -0.002 0.998716    
ordered(lower)219   -22.8936 17888.8048  -0.001 0.998979    
ordered(lower)222   -22.7325 17389.8900  -0.001 0.998957    
metastizedTRUE        0.8575     0.5013   1.711 0.087171 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 8421.80  on 1434  degrees of freedom
Residual deviance:  183.39  on 1358  degrees of freedom
AIC: 387.39

Number of Fisher Scoring iterations: 19</code></pre>
<h3 id="the-survival-package">The survival package</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cx &lt;-<span class="st"> </span><span class="kw">coxph</span>(
  <span class="dt">formula =</span> <span class="kw">Surv</span>(months, event) <span class="op">~</span><span class="st"> </span>metastized,
  <span class="dt">data =</span> df
)

cx</code></pre></div>
<pre><code>Call:
coxph(formula = Surv(months, event) ~ metastized, data = df)

                coef exp(coef) se(coef)   z    p
metastizedTRUE 0.852     2.343    0.502 1.7 0.09

Likelihood ratio test=3.35  on 1 df, p=0.07
n= 44, number of events= 26 </code></pre>

<div id="disqus_thread"></div>
<script>
/**
 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
 */
/*
   var disqus_config = function () {
   this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
   this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
   };
 */
(function() {  // DON'T EDIT BELOW THIS LINE
 var d = document, s = d.createElement('script');

 s.src = '//stappit-github-io.disqus.com/embed.js';

 s.setAttribute('data-timestamp', +new Date());
 (d.head || d.body).appendChild(s);
 })();
</script>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

<script id="dsq-count-scr" src="//stappit-github-io.disqus.com/count.js" async></script>

        </div>
      </article>
    </section>

    <footer class="footer">
      <div class="container text-center">
        <div class="social">
          <a href="https://twitter.com/mcbricall"><i class="fab fa-twitter"></i></a>
          <a href="https://github.com/stappit"><i class="fab fa-github"></i></a>
          <a href="https://www.linkedin.com/in/brian-callander-ba4117140/"><i class="fab fa-linkedin-in"></i></a>
          <a href="https://www.strava.com/athletes/6396953"><i class="fab fa-strava"></i></a>
          <a href="https://www.instagram.com/macbricall/"><i class="fab fa-instagram"></i></a>
          <a href="mailto:briancallander+blog@gmail.com"><i class="far fa-envelope"></i></a>
          <a href="../../atom.xml"><i class="fas fa-rss"></i></a>
        </div>

        </br>

        Site proudly generated by
        <a href="http://jaspervdj.be/hakyll">Hakyll</a>
      </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  </body>
</html>
